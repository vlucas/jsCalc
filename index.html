<html>
<head>
  <title>oseCalc - Embeddable Javascript Calculator</title>
</head>
<body>
  <style type="text/css">
  body {
    margin: 0;
    padding: 0;
  }
  #oseCalc {
    background-color: #eee;
    width: 300px;
    padding: 10px;
    font-family: "Helvetica", "Arial", sans-serif;
  }
  #oseCalc .row {
    display: block;
  }
  #oseCalc #ocBrand {
    float: right;
    font-size: 12px;
    font-family: "Terminal", monospace;
    color: #aaa;
    text-align: right;
  }
  #oseCalc #ocDisplay {
    position: relative;
    overflow: hidden;
    background-color: #fff;
    background-image: -webkit-linear-gradient(top, #ddd, #fff); /* For Chrome and Safari */
    background-image:    -moz-linear-gradient(top, #ddd, #fff); /* For old Fx (3.6 to 15) */
    background-image:     -ms-linear-gradient(top, #ddd, #fff); /* For pre-releases of IE 10*/
    background-image:      -o-linear-gradient(top, #ddd, #fff); /* For old Opera (11.1 to 12.0) */
    background-image:         linear-gradient(to bottom, #ddd, #fff); /* Standard syntax; must be last */
    height: 50px;
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 4px;
    border: 1px solid #bbb;
    text-align: right;
    vertical-align: bottom;
  }
  #oseCalc #ocDisplay #ocDisplayText {
    position: absolute;
    bottom: 4;
    right: 4;
  }
  /* Some button styles taken from Twitter Bootstrap 3.0 */
  #oseCalc button {
    display: inline-block;
    width: 72px;
    height: 60px;
    border: 1px solid #bbb;
    margin: 2px 0;
    font-size: 18px;
    font-weight: normal;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
  }
  #oseCalc button:active {
    background-image: none;
    outline: 0;
    -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, .125);
            box-shadow: inset 0 3px 5px rgba(0, 0, 0, .125);
  }
  #oseCalc button:focus,
  #oseCalc button:active:focus {
    outline: thin dotted;
    outline: 5px auto -webkit-focus-ring-color;
    outline-offset: -2px;
  }
  #oseCalc button:hover,
  #oseCalc button:focus {
    color: #333;
    text-decoration: none;
  }

  /* small buttons */
  #oseCalc .ocBtnSmall {
    height: 35px;
  }
  #oseCalc #ocClear {
    background-color: #C77028;
  }
  #oseCalc #ocClear:active,
  #oseCalc #ocClear:hover {
    background-color: #F08730;
  }

  /* normal buttons */
  #oseCalc .ocNum {
    background-color: #75C98A;
  }
  #oseCalc .ocNum:active,
  #oseCalc .ocNum:hover {
    background-color: lightgreen;
  }
  #oseCalc .ocFunc {
    background-color: #D6B245;
  }
  #oseCalc .ocFunc:active,
  #oseCalc .ocFunc:hover {
    background-color: #F5CC4F;
  }
  </style>

  <div id="oseCalc">
    <div class="row">
      <div id="ocDisplay"><div id="ocDisplayText"></div></div>
    </div>
    <div class="row">
      <div id="ocBrand">oseCalc 3000</div>
      <button id="ocClear" class="ocBtnSmall">C</button>
    </div>
    <div class="row">
      <button id="ocNum7" class="ocNum">7</button>
      <button id="ocNum8" class="ocNum">8</button>
      <button id="ocNum9" class="ocNum">9</button>
      <button id="ocFuncPlus" class="ocFunc">+</button>
    </div>
    <div class="row">
      <button id="ocNum4" class="ocNum">4</button>
      <button id="ocNum5" class="ocNum">5</button>
      <button id="ocNum6" class="ocNum">6</button>
      <button id="ocFuncMinus" class="ocFunc">-</button>
    </div>
    <div class="row">
      <button id="ocNum1" class="ocNum">1</button>
      <button id="ocNum2" class="ocNum">2</button>
      <button id="ocNum3" class="ocNum">3</button>
      <button id="ocFuncMultiply" data-value="*" class="ocFunc">x</button>
    </div>
    <div class="row">
      <button id="ocNum0" class="ocNum">0</button>
      <button id="ocNumDecimal" class="ocNum">.</button>
      <button id="ocFuncEquals" class="ocEquals">=</button>
      <button id="ocFuncDivide" data-value="/" class="ocFunc">&divide;</button>
    </div>
  </div>

  <script>
    // oseCalc
    function oseCalc(options) {
      // Options setup
      this.options = {
        debug: false
      };
      for(key in options) {
        this.options[key] = options[key];
      }

      if(!document.querySelectorAll) {
        this.display('Error: Upgrade Browser');
        return;
      }

      this.bindElements('#oseCalc button.ocNum', this.onClickNumber);
      this.bindElements('#oseCalc button.ocFunc', this.onClickFunction);
      document.getElementById('ocFuncEquals').addEventListener('click', this.calculate.bind(this));
      document.getElementById('ocClear').addEventListener('click', this.reset.bind(this));
    }

    // oseCalc Prototype
    oseCalc.prototype.bindElements = function(selector, fn) {
      var i;
      var el;
      var numbers = document.querySelectorAll(selector);
      var numLength = numbers.length;
      if(numLength > 0) {
        for(i = 0; i < numLength; i++) {
          el = numbers[i];
          el.addEventListener('click', fn.call(this, el));
        }
      }
    };

    /**
     * Handle number click events
     */
    oseCalc.prototype.onClickNumber = function(el) {
      return function(e) {
        var value = e.target.innerHTML;
        if(this.options.debug) {
          this.log('Clicked Number: ' + value);
        }
        this.displayAppend(value);
      }.bind(this);
    };

    /**
     * Handle function click events
     */
    oseCalc.prototype.onClickFunction = function(el) {
      return function(e) {
        var value = e.target.innerHTML;
        // Value override with 'data-value' attribute (for division)
        if(typeof e.target.attributes['data-value'] != "undefined") {
          value = e.target.attributes['data-value'].value;
        }
        if(this.options.debug) {
          this.log('Clicked Function: ' + value);
        }
        this.displayAppend(value);
      }.bind(this);
    };

    /**
     * Log messages (mostly for debugging purposes)
     */
    oseCalc.prototype.log = function(msg) {
      if (typeof console != "undefined") {
        console.log(msg);
      }
    };

    /**
     * Get or set calculator display to the given text
     *
     * @return string
     */
    oseCalc.prototype.display = function(result) {
      if(typeof result == "undefined") {
        return document.getElementById('ocDisplayText').innerHTML;
      }
      document.getElementById('ocDisplayText').innerHTML = result;
      return result;
    };

    /**
     * Append text to the end of the current display
     */
    oseCalc.prototype.displayAppend = function(result) {
      this.display(this.display() + '' + result);
    };

    /**
     * Calculate answer based on input formula
     */
    oseCalc.prototype.calculate = function() {
      this.display(eval(this.display()));
    };

    /**
     * Reset calcultor state (clear memory)
     */
    oseCalc.prototype.reset = function() {
      this.display('');
    };

    // Start new calculator
    ocCalc = new oseCalc({
      debug: true
    });

  </script>
</body>
</html>
